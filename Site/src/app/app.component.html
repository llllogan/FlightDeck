<div class="min-h-screen bg-white text-slate-800">
  <header class="sticky top-0 z-10 border-b border-slate-200 bg-white/80 backdrop-blur">
    <div class="mx-auto max-w-6xl px-4 sm:px-6 py-3 flex items-center justify-between">
      <div class="font-semibold tracking-tight">FlightDeck</div>
      <div class="text-xs text-slate-500">
        <ng-container *ngIf="summary as s; else tagline">
          <span class="mr-3">{{ s.tabGroupCount }} tab groups</span>
          <span class="mr-3">{{ s.tabCount }} tabs</span>
          <span>{{ s.environmentCount }} environments</span>
        </ng-container>
        <ng-template #tagline>Launch your workspace</ng-template>
      </div>
    </div>
  </header>

  <main class="mx-auto max-w-6xl px-4 sm:px-6 py-6 space-y-6">
    <div *ngIf="error" class="rounded-md border border-red-200 bg-red-50 px-4 py-2 text-sm text-red-600">
      {{ error }}
    </div>
    <div *ngIf="loading" class="text-sm text-slate-500">Loading workspaceâ€¦</div>
    <div *ngIf="!loading && !sections.length" class="rounded-md border border-dashed border-slate-300 bg-white px-4 py-6 text-center text-sm text-slate-500">
      No tab groups yet. Click below to add your first group.
    </div>

    <section *ngFor="let section of sections; let i = index" class="space-y-3">
      <div class="flex items-center justify-between">
        <h2 class="text-sm font-semibold text-slate-700">{{ section.group.title }}</h2>
        <button type="button"
                class="rounded-md border border-slate-300 bg-white px-3 py-1 text-xs font-medium text-slate-700 hover:border-slate-400 hover:bg-slate-50 transition"
                (click)="addTab(i)">
          Add Tab
        </button>
      </div>
      <div class="relative -mx-4 sm:mx-0">
        <div class="overflow-x-auto no-scrollbar px-4 sm:px-0">
          <div class="flex gap-3 min-w-full pr-4">
            <ng-container *ngFor="let tabView of section.tabs">
              <a class="shrink-0 w-56 rounded-lg border border-slate-200 bg-white p-3 hover:border-slate-300 hover:shadow-sm transition"
                 [href]="tabView.primaryEnvironment?.url || '#'"
                 target="_blank"
                 rel="noopener">
                <div class="flex items-center gap-3">
                  <img [src]="getFavicon(tabView.primaryEnvironment?.url || '')" alt="" class="h-6 w-6 rounded" />
                  <div class="truncate text-sm text-slate-800">{{ tabView.tab.title }}</div>
                </div>
                <div class="mt-2 truncate text-xs text-slate-500">
                  {{ tabView.primaryEnvironment?.url || 'No environment configured' }}
                </div>
                <div *ngIf="tabView.primaryEnvironment?.name" class="mt-1 text-[11px] uppercase tracking-wide text-slate-400">
                  {{ tabView.primaryEnvironment?.name }}
                </div>
              </a>

              <div *ngIf="tabView.environments.length" class="shrink-0 w-56 px-1 text-xs text-slate-500">
                <div class="flex flex-wrap gap-2">
                  <a *ngFor="let env of tabView.environments"
                     [href]="env.url"
                     target="_blank"
                     rel="noopener"
                     class="rounded-full border border-slate-300 px-2 py-0.5 hover:border-slate-400 hover:text-slate-700 transition">
                    {{ env.name }}
                  </a>
                </div>
              </div>
            </ng-container>

            <button type="button"
                    class="shrink-0 w-56 rounded-lg border border-dashed border-slate-300 bg-white/80 p-3 text-slate-600 hover:border-slate-400 hover:bg-slate-50 transition"
                    (click)="addTab(i)">
              <div class="flex items-center gap-3">
                <span class="grid h-6 w-6 place-items-center rounded bg-slate-100 text-slate-700">+</span>
                <div class="truncate text-sm font-medium">Add Tab</div>
              </div>
              <div class="mt-2 text-xs text-slate-500">Add a URL to this group</div>
            </button>
          </div>
        </div>
      </div>
    </section>

    <div class="pt-4">
      <button type="button"
              class="w-full rounded-md border border-dashed border-slate-300 bg-white py-3 text-sm font-medium text-slate-700 hover:border-slate-400 hover:bg-slate-50 transition"
              (click)="addSection()">
        + Add Tab Group
      </button>
    </div>
  </main>
</div>
